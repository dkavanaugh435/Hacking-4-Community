<html>

<head>
    <link rel='stylesheet' type='text/css' href='https://api.tomtom.com/maps-sdk-for-web/cdn/5.x/5.69.1/maps/maps.css'>
    <script src="https://api.tomtom.com/maps-sdk-for-web/cdn/5.x/5.69.1/maps/maps-web.min.js"></script>
    <script src="https://api.tomtom.com/maps-sdk-for-web/cdn/5.x/5.69.1/services/services-web.min.js"></script>
</head>

<body>

    <input type="text" id="queue" value="">
    <button onclick="search()">SEARCH</button>
    <button onclick="clearMark()">Clear</button>
    <div id="map" style="width: 1280; height: 720;"></div>
    <script>
        var la = [-118.24, 34.05]
        var map = tt.map({
            key: "B9K6O9ENhZT2yTvZpBVmDU8Q6JBzSlle",
            center: la,
            container: "map",
            zoom: 14,
            style: 'tomtom://vector/1/basic-main'
        });

        var markers = []
        map.on('click', function(event){
            console.log(event)
            var marker = new tt.Marker()
                .setLngLat(event.lngLat)
                .addTo(map);
            markers.push(marker)
        })

        var clearMark = function() {
            for(marker of markers) {
                marker.remove();
            }
            markers = [];
        }

        var move = function(lnglat) {
            map.flyTo({
                center:lnglat,
                zoom: 14
            })
        }

        var handleResults = function(result) {
            console.log(result);
            if (result.results) {
                move(result.results[0].position)

                var marker = new tt.Marker()
                    .setLngLat(result,results[0].position)
                    .addTo(map);
            }
        }

        var search = function() {
            tt.services.fuzzySearch({
                key: "B9K6O9ENhZT2yTvZpBVmDU8Q6JBzSlle",
                query: document.getElementById("queue").value,
                boundingBox: map.getBounds()

            }).go().then(handleResults)
        }
    </script>
</body>

</html>
